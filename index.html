<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Trade Forum</title>
<style>
body { margin:0; font-family:Arial,sans-serif; background:linear-gradient(135deg,#21006E 0%,#140044 51%,#070016 100%); color:white; }
#forum { max-width:800px; margin:40px auto; padding:30px; }
.card { background:rgba(255,255,255,0.06); backdrop-filter:blur(10px); padding:20px; border-radius:16px; margin-bottom:20px; }
input, button { width:100%; padding:12px; border-radius:10px; border:none; margin-bottom:12px; }
input { background:rgba(0,0,0,0.4); color:white; }
button { background:linear-gradient(135deg,#6f4cff,#9b7bff); color:white; font-weight:600; cursor:pointer; }
.post { background:rgba(255,255,255,0.05); padding:14px; border-radius:14px; margin-bottom:12px; }
.username { color:#c7b8ff; font-weight:600; }
.trade-line { font-size:14px; margin-top:4px; }
.game { font-size:13px; opacity:0.85; margin-top:2px; }
.time { font-size:12px; opacity:0.6; margin-top:4px; }
.timer-text { font-size:13px; opacity:0.85; margin-top:10px; }
.info-text { font-size:13px; opacity:0.75; margin-top:18px; line-height:1.4; }
</style>
</head>
<body>
<div id="forum">
  <div class="card">
    <h2>Trade Requests</h2>
    <input id="username" placeholder="Roblox Username">
    <input id="game" placeholder="Roblox Game">
    <input id="give" placeholder="Item You Are Giving">
    <input id="want" placeholder="Item You Want">
    <button onclick="post()">Post Trade</button>
    <p id="timer" class="timer-text"></p>
  </div>

  <div id="posts"></div>

  <p class="info-text">
    <b>How to complete a trade:</b><br>
    Copy the traderâ€™s Roblox username shown above, then add them as a friend on Roblox to negotiate and complete the deal in-game.
  </p>
</div>

<script>
const COOLDOWN = 60*60*1000;
const EXPIRY = 3*60*60*1000;
const API = "https://api.npoint.io/your_unique_endpoint_here"; // pre-made global backend
const bannedWords = ["fuck","shit","bitch","asshole","nigger","faggot","retard","cunt","slut","whore"];

function containsBanned(text){ return bannedWords.some(w=>text.toLowerCase().includes(w)); }

async function loadPosts(){
  let posts = await (await fetch(API)).json();
  const now = Date.now();
  posts = posts.filter(p=>now - p.time < EXPIRY);
  document.getElementById("posts").innerHTML = "";
  posts.reverse().forEach(p=>{
    document.getElementById("posts").innerHTML +=
      `<div class="post">
        <div class="username">${p.user}</div>
        <div class="game">Game: ${p.game}</div>
        <div class="trade-line"><b>Giving:</b> ${p.give}</div>
        <div class="trade-line"><b>Want:</b> ${p.want}</div>
        <div class="time">${new Date(p.time).toLocaleString()}</div>
      </div>`;
  });
  updateTimer(posts);
}

function updateTimer(posts){
  const timer = document.getElementById("timer");
  if(!posts.length){ timer.textContent="Offers will delete in 3h 0m 0s"; return; }
  const oldest = Math.min(...posts.map(p=>p.time));
  const remaining = EXPIRY-(Date.now()-oldest);
  const h=Math.floor(remaining/3600000);
  const m=Math.floor((remaining%3600000)/60000);
  const s=Math.floor((remaining%60000)/1000);
  timer.textContent=`Offers will delete in ${h}h ${m}m ${s}s`;
}

async function post(){
  const user=document.getElementById("username").value.trim();
  const game=document.getElementById("game").value.trim();
  const give=document.getElementById("give").value.trim();
  const want=document.getElementById("want").value.trim();
  const lastPost = localStorage.getItem("lastPostTime");
  const now = Date.now();

  if(!user||!game||!give||!want){ return alert("All fields required"); }
  if([user,game,give,want].some(containsBanned)){ return alert("Message contains inappropriate language"); }
  if(lastPost && now - lastPost < COOLDOWN){ return alert("You must wait 1 hour before posting again."); }

  let posts = await (await fetch(API)).json();
  posts.push({user,game,give,want,time:now});
  await fetch(API, {method:"PUT", headers:{"Content-Type":"application/json"}, body:JSON.stringify(posts)});
  localStorage.setItem("lastPostTime", now);
  document.getElementById("give").value="";
  document.getElementById("want").value="";
  loadPosts();
}

setInterval(loadPosts,5000);
loadPosts();
</script>
</body>
</html>
